<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>History</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
      integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
      crossorigin="anonymous"
    />
    <style>
      body {
        background-color: rgb(251, 253, 255);
      }
    </style>
  </head>
  <body>
    <div class="container py-4" style="max-width: 666px">
      <h3>公元纪年转换农历纪年</h3>
      <div class="form-inline mb-3">
        <div class="form-group mb-2">
          <select id="inputCEYearType" class="form-control">
            <option value="-1">公元前</option>
            <option value="1" selected>公元后</option>
          </select>
        </div>
        <div class="form-group mx-sm-3 mb-2">
          <label for="inputCEYear" class="sr-only">Password</label>
          <input
            type="text"
            class="form-control"
            id="inputCEYear"
            placeholder="年份"
          />
        </div>
        <button class="btn btn-primary mb-2" id="ce2lunisolar-btn">转换</button>
        <span class="ml-3" id="currentYear"></span>
      </div>

      <h3>历史纪年</h3>
      <p>
        数据来源：
        <a href="http://ctext.org" target="_blank" rel="noopener noreferrer"
          ><code>https://ctext.org</code></a
        >
      </p>
      <div id="dynasties" class="row">
        <div class="spinner-grow ml-3" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
    </div>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>
    <script src="./main.js"></script>
    <script src="./ce2lunisolar.js"></script>
    <script>
      $(function () {
        var $inputCEYearType = $("#inputCEYearType");
        var $inputCEYear = $("#inputCEYear");
        var $currentYear = $("#currentYear");
        var $convBtn = $("#ce2lunisolar-btn");
        var yearTypeMap = { "-1": "公元前", 1: "公元后" };

        main();

        function main() {
          $inputCEYear.on("keyup", function (evt) {
            if (evt.keyCode === 13) convHandle();
          });
          $convBtn.click(convHandle);
          updateResult(1, new Date().getFullYear());
        }

        function convHandle() {
          var type = $inputCEYearType.val();
          var year = $inputCEYear.val();
          if (!year || isNaN(year)) {
            alert("请输入有效年份值！");
            return;
          }
          updateResult(type, year);
        }

        function updateResult(yearType, year) {
          var h = "".concat(
            yearTypeMap[yearType],
            " ",
            year,
            " 年是<b>",
            ce2lunisolar(year, yearType),
            "年</b>"
          );
          $currentYear.html(h);
        }
      });
    </script>
  </body>
</html>
